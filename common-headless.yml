---
- tags: [common-headless]
  hosts: all
  become_method: sudo
  tasks:
  - command: rustup toolchain install stable
  - command: rustup default stable

  - user: name={{ ansible_env.USER }} shell=/usr/bin/zsh
    become: true

  - git: repo=https://github.com/robbyrussell/oh-my-zsh.git dest=~/.oh-my-zsh

  - git: repo=https://github.com/luan/vimfiles dest=~/.vim

  - git: repo=https://github.com/tmux-plugins/tpm dest=~/.tmux/plugins/tpm

  - file: src={{item.src}} dest={{item.dest}} state=link force=true
    with_items:
    - {src: "{{ansible_env.PWD}}/config/zshrc", dest: ~/.zshrc}
    - {src: "{{ansible_env.PWD}}/config/tmux.conf", dest: ~/.tmux.conf}
    - {src: "{{ansible_env.PWD}}/config/gitconfig", dest: ~/.gitconfig}
    - {src: "{{ansible_env.PWD}}/config/vimrc.local.plugins", dest: ~/.vimrc.local.plugins}
