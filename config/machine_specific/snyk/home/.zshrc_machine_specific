# Apparently intel only
source "$HOMEBREW_PREFIX/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/path.zsh.inc"

snyk-dev() {
  (
    cd ~/workspace/github.com/snyk/snyk
    if [ -n "${SNYK_REBUILD:-}" ]; then
      npm run build
    fi
    if [ -n "${SNYK_REGEN_HELP:-}" ]; then
      NO_DOCKER=1 npm run generate-help
    fi
    node ./dist/cli "$@"
  )
}

export GOPRIVATE=github.com/snyk

snykctl() {
  if [ -z "${1:-}" ]; then
    echo "usage: snykctl <sv-action> <service> (default: cwd)>"
    return 1
  fi

  local service="${2:-"$(basename "$PWD")"}"
  local sv_dir="$HOME/workspace/github.com/craigfurman/snykctl/sv"

  sv "${1}" "${sv_dir}/${service}"
}
